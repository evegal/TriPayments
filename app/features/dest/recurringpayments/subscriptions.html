<!--include ../modals/mock.html--><!--include ../modals/midsEditModal.html--><!--include ../modals/addMIDSmodal.html--><!--include ../modals/midsConfirmModal.html--><!--include ../modals/merchantRemoveModal.html--><!--include ../modals/merchantCreateModal.jade--><!--include ../modals/merchantEditModal.jade-->
<script type="text/ng-template" id="subscriptionCreateModal.html"><div class="midCreateEditModal midCreateModal"><div class="modal-header"><h3>Create New Subscription</h3><button type="button" ng-click="cancel()" class="close">X </button></div><div class="modal-body"><wizard on-finish="finishedWizard()"><wz-step title="1. Subscription Config">                         <form name="subscriptionFormProfile" novalidate="novalidate" class="midCreateModal stepOne"><div class="row"><div class="col-md-4"><label>*Subscription Name:</label></div><div class="col-md-6"><input required="" ng-model="subscriptionFormName" id="subscriptionFormName" type="text" placeholder="Enter subscription name  (Required)" tooltip="Select a name to identify this subscription. (Required)" tooltip-placement="top" class="form-control"/></div></div><div class="row"><div class="col-md-4"><label>Recurring Type:</label></div><div class="col-md-3"><select id="subscriptionFormRecurringType" tooltip="Select type of recurring cycle (Required) " tooltip-placement="top" class="form-control"><option value="1">Calendar</option><option value="2">Num Days</option></select></div><div class="col-md-3"><input id="subscriptionFormDateVal" type="number" placeholder="value" tooltip="Enter value (Required)" tooltip-placement="top" class="form-control"/></div></div><div class="row"><div class="col-md-4"><label>*Recurring Amount:</label></div><div class="col-md-6"> <input required="" ng-model="subscriptionFormAmount" id="subscriptionFormAmount" type="number" tooltip-placement="top" placeholder="Enter value. (Required)" tooltip="Enter value for recurring amount (Required)" class="form-control"/></div></div><div class="row modalCenterTxt"><p> <label tooltip="Select allowed payment types.  (Required)" tooltip-placement="top">*Payment Types: (Required)</label></p></div><div class="row paymentTypeDiv"><div class="col-md-3"><input name="cardCheckbox" type="checkbox" value="1"/><i class="fa fa-cc-amex fa-2x"></i></div><div class="col-md-3"><input name="cardCheckbox" type="checkbox" value="2"/><i class="fa fa-cc-visa fa-2x"></i></div><div class="col-md-3"><input name="cardCheckbox" type="checkbox" value="3"/><i class="fa fa-cc-mastercard fa-2x"></i></div><div class="col-md-3"><input name="cardCheckbox" type="checkbox" value="4"/><i class="fa fa-cc-discover fa-2x"></i></div></div><div class="row modalCenterTxt"><p> <label tooltip="Select allowed currency types.  (Required)" tooltip-placement="top">*Currency Types: (Required)</label></p></div><div class="row currencyTypeDiv"><div class="col-md-3"><input name="curTypeCheckbox" type="checkbox" value="12"/><span>USD - United States Dollar</span></div><div class="col-md-3"><input name="curTypeCheckbox" type="checkbox" value="3"/><span>AUD - Australia Dollar</span></div><div class="col-md-3"><input name="curTypeCheckbox" type="checkbox" value="10"/><span>BRL -Brazil Real</span></div><div class="col-md-3"><input name="curTypeCheckbox" type="checkbox" value="4"/><span>CAD - Canada Dollar</span></div><div class="col-md-3"><input name="curTypeCheckbox" type="checkbox" value="5"/><span>DKK - Denmark Krone</span></div><div class="col-md-3"><input name="curTypeCheckbox" type="checkbox" value="2"/><span>EUR -Euro Member </span></div><div class="col-md-3"><input name="curTypeCheckbox" type="checkbox" value="1"/><span>GBP - UK Pound</span></div><div class="col-md-3"><input name="curTypeCheckbox" type="checkbox" value="7"/><span>JPY - Japan Yen</span></div><div class="col-md-3"><input name="curTypeCheckbox" type="checkbox" value="8"/><span>NOK - Norway Krone</span></div><div class="col-md-3"><input name="curTypeCheckbox" type="checkbox" value="6"/><span>NZD - New Zealand Dollar</span></div><div class="col-md-3"><input name="curTypeCheckbox" type="checkbox" value="9"/><span>SEK - Sweden Krona</span></div><div class="col-md-3"><input name="curTypeCheckbox" type="checkbox" value="11"/><span>SGD - Singapore Dollar</span></div></div><div class="row"><div class="col-md-6 text-left"><a tooltip="Previous selection not available in first step" tooltip-placement="top" class="row_btn disabled_btn"><i class="fa fa-arrow-left"></i><span>Previous</span></a></div><div class="col-md-6 text-right"><a href="" type="submit" ng-click="subscriptionCreateConfig(subscriptionFormProfile)" class="row_btn emerald_btn"><span>Next</span><i class="fa fa-arrow-right"></i></a></div></div><div class="row errorMsg"><p>{{errorMsg}}</p></div></form></wz-step><wz-step title="2. Processing for Subscription" class="stepTwo"><form name="subscriptionSelProcessingForm" novalidate="novalidate" class="midCreateModal stepOne"><div class="row"><div class="col-md-4"><label>*Processing Type:</label></div><div class="col-md-6"><select ng-model="subscriptionSelProcessingType" id="subscriptionSelProcessingType" tooltip="Please select which MID Group or MID that will process the recurring transactions for this plan. (Required)" tooltip-placement="top" class="form-control"><option value="">Select </option><option value="1">MID Group</option><option value="2">MID</option></select></div></div><div ng-if="subscriptionSelProcessingType == 1" class="row"><div class="col-md-4"><label>*Select MID Group:</label></div><div class="col-md-6"><select required="" ng-model="currentProcessor" ng-change="selectProcessingType(currentProcessor)" ng-options="obj.Id as obj.DisplayName for obj in subscriptionProcessors.AvailableMidGroups" class="form-control"><option value="">Select </option></select></div></div><div ng-if="subscriptionSelProcessingType == 2" class="row"><div class="col-md-4"><label>*Select MID:</label></div><div class="col-md-6"><select required="" ng-model="currentProcessor" ng-change="selectProcessingType(currentProcessor)" ng-options="obj.Id as obj.DisplayName for obj in subscriptionProcessors.AvailableMids" class="form-control"><option value="">Select </option></select></div></div></form><div class="row"><div class="col-md-6 text-left"><a href="" type="submit" wz-previous="" class="row_btn emerald_btn"><i class="fa fa-arrow-left"></i><span>Previous</span></a></div><div class="col-md-6 text-right"><a href="" type="submit" ng-click="subscriptionSelectProcessing(subscriptionSelProcessingForm)" class="row_btn emerald_btn"><span>Next</span><i class="fa fa-arrow-right"></i></a></div></div><div class="row errorMsg"><p>{{errorMsg}}</p></div></wz-step><wz-step title="3. Decline Rules" class="stepTwo"><form name="subscriptionDeclineForm" novalidate="novalidate" class="midCreateModal stepOne"><div class="row"><form><div class="row"><p>Decline Rules for Credit Cards:</p></div><div class="row"><div class="col-md-6"><select required="" id="subscriptionCCAttempt" tooltip="Select the number of attempts once a credit card has been declined. (Required) " tooltip-placement="top" class="form-control"><option value="">Select Attempts (Credit Card)</option><option value="1">Attempt 1 time</option><option value="2">Attempt 2 times</option><option value="3">Attempt 3 times</option><option value="4">Attempt 4 times</option><option value="5">Attempt 5 times</option></select></div><div class="col-md-6"><select required="" id="subscriptionCCAttemptLapse" tooltip="Select the number of days between each attempt. (Required) " tooltip-placement="top" class="form-control"><option value="">Select lapse time for attempts</option><option value="1">1 days lapse</option><option value="2">2 days lapse</option><option value="3">3 days lapse</option><option value="4">4 days lapse</option><option value="5">5 days lapse</option><option value="6">6 days lapse</option><option value="7">7 days lapse</option><option value="8">8 days lapse</option><option value="9">9 days lapse</option><option value="10">10 days lapse</option><option value="11">11 days lapse</option><option value="12">12 days lapse</option><option value="13">13 days lapse</option><option value="14">14 days lapse</option><option value="15">15 days lapse</option></select></div></div><div class="row"><p>Decline Rules for ACH:</p></div><div class="row"><div class="col-md-6"><select required="" id="subscriptionACHAttempt" tooltip="Select the number of attempts once a ACH transaction has been declined. (Required) " tooltip-placement="top" class="form-control"><option value="">Select attempts (ACH)</option><option value="1">Attempt 1 time</option><option value="2">Attempt 2 times</option><option value="3">Attempt 3 times</option><option value="4">Attempt 4 times</option><option value="5">Attempt 5 times</option></select></div><div class="col-md-6"><select required="" id="subscriptionACHAttemptLapse" tooltip="Select the number of days between each attempt. (Required) " tooltip-placement="top" class="form-control"><option value="">Select lapse time for attempts</option><option value="1">1 day lapse</option><option value="2">2 days lapse</option><option value="3">3 days lapse</option><option value="4">4 days lapse</option><option value="5">5 days lapse</option><option value="6">6 days lapse</option><option value="7">7 days lapse</option><option value="8">8 days lapse</option><option value="9">9 days lapse</option><option value="10">10 days lapse</option><option value="11">11 days lapse</option><option value="12">12 days lapse</option><option value="13">13 days lapse</option><option value="14">14 days lapse</option><option value="15">15 days lapse</option></select></div></div><div class="row"><p>Declined Email Notification:</p></div><div class="row"><input required="" ng-model="subscriptionDeclinedEmail" id="subscriptionDeclinedEmail" type="text" placeholder="Enter Email. (Required)" tooltip="Enter email to receive notification of failed transactions. (Required)" tooltip-placement="top" class="form-control"/></div></form></div><div class="row"><div class="col-md-6 text-left"><a href="" type="submit" wz-previous="" class="row_btn emerald_btn"><i class="fa fa-arrow-left"></i><span>Previous</span></a></div><div class="col-md-6 text-right"><a href="" type="submit" ng-click="subscriptionDeclineRules(subscriptionDeclineForm)" class="row_btn emerald_btn"><span>Next</span><i class="fa fa-arrow-right"></i></a></div></div><div class="row errorMsg"><p>{{errorMsg}}</p></div></form></wz-step></wizard></div><div class="modal-footer action_group"><a href="" ng-click="cancel()" class="row_btn cancel_btn"><i class="fa fa-sign-out"></i><span>Exit</span></a></div></div></script><script type="text/ng-template" id="subscriptionDeleteModal.html"><div class="modal-header"><h3 class="modal-title"><span class="subtle">Delete Subscription: </span><span>{{subscriptionName}}</span></h3><button type="button" ng-click="cancel()" class="close">x</button></div><div class="modal-body"><p class="text-center">Are you sure you want to delete {{subscriptionName}}?</p><div class="userCreateSuccess"><p>Subscription Deleted</p></div><div class="row errorMsg"><p>{{errorMsg}}</p></div></div><div class="modal-footer"><a href="" ng-click="deleteSubscription()" class="row_btn action_btn"> <i class="fa fa-trash"></i><span>Delete</span></a><a href="" ng-click="cancel()" class="row_btn cancel_btn"><i class="fa fa-sign-out"></i><span>Exit</span></a></div></script><!--createSubscriptionModalCtrl--><div class="row"><h1>Recurring Payments - Subscriptions</h1></div><div class="merchant_view"><div class="panel panel-default"><div class="panel-heading"><div class="row"><div class="col-md-6"><h2 class="panel-title"><i class="fa fa-icon"></i>Current Subscriptions :</h2></div><div class="col-md-6"><a href="" ng-csv="subscriptionsCSV" filename="subscribersExport.csv" ng-if="subscriptionCount != 0" class="def_btn wet_asphalt_btn float-right"><i class="fa fa-file-excel-o"> </i><span>Excel Export</span></a><a href="" ng-click="open()" ng-controller="subscriptionsCreateModal" class="def_btn emerald_btn float-right margin-right"> <i class="fa fa-plus"></i><span>Create Subscription</span></a></div></div></div><div class="panel-body"><h3 ng-if="subscriptionCount == 0" class="noResults">{{'There are currently no subscriptions setup.'}} </h3><accordion ng-if="subscriptionCount != 0"><table st-table="displaySubscriptions" st-safe-src="subscriptionsOriginal" class="table ng-table-responsive table-striped"><thead><tr><th colspan="6"><input st-search="" type="search" placeholder="Filter through all subscriptions" class="form-control"/></th><tr><th st-sort="subscription.DisplayName" width="20%" class="st-header">Name</th><th st-sort="" width="10%" class="st-header">Recurring Type</th><th st-sort="" width="5%" class="st-header">Day</th><th st-sort="" width="5%" class="st-header">Amount</th><th st-sort="" width="10%" class="st-header">Next Invoice Date</th><th width="30%" class="st-header-nosort">Actions </th></tr></tr></thead><tbody ng-repeat="subscription in displaySubscriptions"><tr id="base{{$index}}"><td>{{subscription.DisplayName}}</td><td ng-if="subscription.PlanType.Id == 1">Calendar Date</td><td ng-if="subscription.PlanType.Id == 2">Cycle Days</td><td>{{subscription.CalendarDayOrInterval}}</td><td>{{subscription.Amount | currency}}</td><td>{{subscription.NextBillingDate | date:'MM/dd/yyyy'}}</td><td><a href="" ng-click="openMID(merchant); loadMIDS(merchant.Id,merchant); checkWindow(shownMerchants)" ng-controller="addMIDSmodalCtrl" class="row_btn emerald_btn margin-right"><i class="fa fa-plus"></i><span>Add Subscribers</span></a><a href="" ng-click="loadMIDS(merchant.Id,merchant); gotoMID($index,shownMerchants)" class="row_btn wet_asphalt_btn margin-right"><i class="fa fa-eye"></i><span>View Subscribers</span></a><a ng-click="open(merchant)" ng-controller="editMerchantModalCtrl" class="row_btn turquoise_btn margin-right"> <i class="fa fa-edit"></i><span>Edit Subscription</span></a><a ng-click="open($index,subscription.SubscriptionId,subscription.DisplayName)" ng-controller="subscriptionDeleteModalCtrl" class="row_btn alazarin_btn"> <i class="fa fa-trash"> </i><span>Delete Subscription</span></a></td><td class="hidden_td"><tr><td colspan="6" class="pushToggle"><accordion-group heading="" ng-click="loadMIDS(merchant.Id,merchant)" is-open="merchant.open"><table class="table table-striped"><thead><tr><th>MID Name</th><th>Rollover MID</th><th>Monthly Cap</th><th>Actions</th></tr></thead><tbody><tr ng-repeat="mid in mids"><td>{{mid.DisplayName}}</td><td>{{mid.RolloverMidName}}</td><td>{{mid.MonthlyCap}}</td><td> <a ng-click="openIt(mid)" ng-controller="midsModalCtrl" class="row_btn turquoise_btn margin-right"> <i class="fa fa-edit"></i><span>Edit</span></a><a ng-click="openMID($index,mid)" ng-controller="midsConfirmModalCtrl" class="row_btn alazarin_btn margin-right"> <i class="fa fa-trash"></i><span>Remove</span></a></td></tr></tbody></table></accordion-group></td></tr></td></tr></tbody></table></accordion></div></div></div><!--.rowh1 Recurring Payments - Subscriptions--><!--.merchant_view.panel.panel-default
  .panel-heading
    .row
          .col-md-6
            h2.panel-title
              i.fa.fa-icon
              | Subscriptions
          .col-md-6
              a.def_btn.wet_asphalt_btn.float-right(href="" ng-csv='groupCSV' filename="groupExport.csv" ng-if="groupAmount != 0")
                i.fa.fa-file-excel-o 
                span Excel Export
              a.def_btn.emerald_btn.float-right.margin-right(href="" ng-click="open()" ng-controller="createMerchantModalCtrl") 
                i.fa.fa-plus
                span Create MID Group
  .panel-body
    h3.noResults(ng-if="groupAmount == 0") {{'There are currently no MID groups setup for this account.'}} 
    accordion(ng-if="groupAmount != 0")
      table.table.ng-table-responsive.table-striped(st-table="shownMerchants" st-safe-src="groupsBulk")
           thead
             tr
               th(colspan="7")
                 input.form-control(st-search="" type="search" placeholder="Filter through all MID groups")
               tr
                 th.st-header(st-sort="Name") Merchant Name
                 th.st-header(st-sort="BalancingType") Balancing Type
                 //th.st-header(st-sort="CapLimitNotificationEmails" style="width:15%") Cap Limit Notification Email
                 th.st-header(st-sort="Currency.Name") Currency Name
                 th.st-header-nosort(style="width:25%" colspan="2") Actions
            
           tbody(ng-repeat="merchant in shownMerchants")


             tr(id="base{{$index}}")
               td {{merchant.Name}}
               td {{merchant.BalancingType}}
               //td {{merchant.CapLimitNotificationEmails}}
               td {{merchant.Currency.Name}}
               td
                 a.row_btn.emerald_btn.margin-right(href="" ng-click="openMID(merchant); loadMIDS(merchant.Id,merchant); checkWindow(shownMerchants)" ng-controller="addMIDSmodalCtrl")
                    i.fa.fa-plus
                    span Add MIDs
                 a.row_btn.wet_asphalt_btn.margin-right(href="" ng-click="loadMIDS(merchant.Id,merchant); gotoMID($index,shownMerchants)")
                    i.fa.fa-eye
                    span Mids
                 a.row_btn.turquoise_btn.margin-right(ng-click="open(merchant)" ng-controller="editMerchantModalCtrl") 
                    i.fa.fa-edit
                    span Edit
                 a.row_btn.alazarin_btn(ng-click="open($index,merchant)" ng-controller="removeMerchantModalCtrl") 
                    i.fa.fa-trash
                    span Delete
               td.hidden_td
                  tr
                    td.pushToggle(colspan="6")
                      accordion-group(heading="" ng-click="loadMIDS(merchant.Id,merchant)" is-open="merchant.open")
                        table.table.table-striped
                          thead
                            tr
                              th MID Name
                              th Rollover MID
                              th Monthly Cap
                              th Actions

                          tbody
                            tr(ng-repeat="mid in mids")
                              td {{mid.DisplayName}}
                              td {{mid.RolloverMidName}}
                              td {{mid.MonthlyCap}}
                              td 
                                  a.row_btn.turquoise_btn.margin-right(ng-click="openIt(mid)" ng-controller="midsModalCtrl") 
                                    i.fa.fa-edit
                                    span Edit
                                  a.row_btn.alazarin_btn.margin-right(ng-click="openMID($index,mid)" ng-controller="midsConfirmModalCtrl") 
                                    i.fa.fa-trash
                                    span Remove-->